<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>TODO</title>
<!-- 2018-05-27 нд 22:54 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="voloyev" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="style.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">TODO</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-0-1">0.1. Agenda</a></li>
</ul>
</li>
<li><a href="#sec-1">1. unix shell</a>
<ul>
<li><a href="#sec-1-1">1.1. profile vs bashrc/zshrc</a></li>
<li><a href="#sec-1-2">1.2. Second profile vs bashrc</a></li>
<li><a href="#sec-1-3">1.3. my bash setup</a></li>
<li><a href="#sec-1-4">1.4. my zsh setup</a></li>
<li><a href="#sec-1-5">1.5. fish</a></li>
</ul>
</li>
<li><a href="#sec-2">2. bundle exec</a></li>
<li><a href="#sec-3">3. rvm, rbenv</a>
<ul>
<li><a href="#sec-3-1">3.1. rvm</a>
<ul>
<li><a href="#sec-3-1-1">3.1.1. linux</a></li>
<li><a href="#sec-3-1-2">3.1.2. macos</a></li>
</ul>
</li>
<li><a href="#sec-3-2">3.2. rbenv</a>
<ul>
<li><a href="#sec-3-2-1">3.2.1. linux</a></li>
</ul>
</li>
<li><a href="#sec-3-3">3.3. macos</a></li>
</ul>
</li>
<li><a href="#sec-4">4. editors</a>
<ul>
<li><a href="#sec-4-1">4.1. vim</a></li>
<li><a href="#sec-4-2">4.2. emacs</a></li>
<li><a href="#sec-4-3">4.3. others</a></li>
</ul>
</li>
<li><a href="#sec-5">5. git</a>
<ul>
<li><a href="#sec-5-1">5.1. difference from vcs, merccurial</a></li>
<li><a href="#sec-5-2">5.2. pull-request</a></li>
</ul>
</li>
<li><a href="#sec-6">6. deploy</a>
<ul>
<li><a href="#sec-6-1">6.1. capistrano</a></li>
<li><a href="#sec-6-2">6.2. ansible</a></li>
<li><a href="#sec-6-3">6.3. chef</a></li>
<li><a href="#sec-6-4">6.4. cd/ci</a></li>
</ul>
</div>
</div>

<div id="outline-container-sec-0-1" class="outline-3">
<h3 id="sec-0-1"><span class="section-number-3">0.1</span> Agenda</h3>
<div class="outline-text-3" id="text-0-1">
<p>
bash, zsh, fish
RVM
RBENV
chruby
what is bundle exec
Docker, docker-compose, warm up project
</p>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> unix shell</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> profile vs bashrc/zshrc</h3>
<div class="outline-text-3" id="text-1-1">
<p>
.bash<sub>profile</sub> and .bashrc are specific to bash, whereas .profile is read by many shells in the absence of their own shell-specific config files. (.profile was used by the original Bourne shell.) .bash<sub>profile</sub> or .profile is read by login shells, along with .bashrc; subshells read only .bashrc. (Between job control and modern windowing systems, .bashrc by itself doesn't get used much. If you use screen or tmux, screens/windows usually run subshells instead of login shells.)
</p>

<p>
The idea behind this was that one-time setup was done by .profile (or shell-specific version thereof), and per-shell stuff by .bashrc. For example, you generally only want to load environment variables once per session instead of getting them whacked any time you launch a subshell within a session, whereas you always want your aliases (which aren't propagated automatically like environment variables are).
</p>

<p>
Other notable shell config files:
</p>

<p>
/etc/bash<sub>profile</sub> (fallback /etc/profile) is read before the user's .profile for system-wide configuration, and likewise /etc/bashrc in subshells (no fallback for this one). Many systems including Ubuntu also use an /etc/profile.d directory containing shell scriptlets, which are . (source)-ed from /etc/profile; the fragments here are per-shell, with *.sh applying to all Bourne/POSIX compatible shells and other extensions applying to that particular shell.
</p>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Second profile vs bashrc</h3>
<div class="outline-text-3" id="text-1-2">
<p>
The main difference with shell config files is that some are only read by "login" shells (eg. when you login from another host, or login at the text console of a local unix machine). these are the ones called, say, .login or .profile or .zlogin (depending on which shell you're using).
</p>

<p>
Then you have config files that are read by "interactive" shells (as in, ones connected to a terminal (or pseudo-terminal in the case of, say, a terminal emulator running under a windowing system). these are the ones with names like .bashrc, .tcshrc, .zshrc, etc.
</p>

<p>
bash complicates this in that .bashrc is only read by a shell that's both interactive and non-login, so you'll find most people end up telling their .bash<sub>profile</sub> to also read .bashrc with something like
</p>

<p>
<i> -r ~/.bashrc </i> &amp;&amp; . ~/.bashrc
</p>

<p>
Other shells behave differently - eg with zsh, .zshrc is always read for an interactive shell, whether it's a login one or not.
</p>

<p>
The manual page for bash explains the circumstances under which each file is read. Yes, behaviour is generally consistent between machines.
</p>

<p>
.profile is simply the login script filename originally used by /bin/sh. bash, being generally backwards-compatible with /bin/sh, will read .profile if one exists
</p>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> my bash setup</h3>
<div class="outline-text-3" id="text-1-3">
<p>
<a href="https://github.com/voloyev/EmacsConfig/blob/master/.bashrc">https://github.com/voloyev/EmacsConfig/blob/master/.bashrc</a>
</p>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> my zsh setup</h3>
<div class="outline-text-3" id="text-1-4">
<p>
<a href="https://github.com/voloyev/EmacsConfig/blob/master/.zshrc">https://github.com/voloyev/EmacsConfig/blob/master/.zshrc</a>
</p>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> fish</h3>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> bundle exec</h2>
<div class="outline-text-2" id="text-2">
<p>
bundle exec is a Bundler command to execute a script in the context of the current bundle (the one from your directory's Gemfile). rake db:migrate is the script where db is the namespace and migrate is the task name defined.
So bundle exec rake db:migrate executes the rake script with the command db:migrate in the context of the current bundle.
As to the "why?" I'll quote from the bundler page:
In some cases, running executables without bundle exec may work, if the executable happens to be installed in your system and does not pull in any gems that conflict with your bundle.
However, this is unreliable and is the source of considerable pain. Even if it looks like it works, it may not work in the future or on another machine.
Bundler is a Ruby gem that’s a little special because it manages other Ruby gems. It does basically three things:
It does a topological sort of the gems listed in your Gemfile to print a complete graph of your project’s dependencies into Gemfile.lock
It retrieves the gems your project needs from the source(s) you’ve defined
And it makes it so when you require files the right file is loaded.
</p>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> rvm, rbenv</h2>
<div class="outline-text-2" id="text-3">
<p>
The two most popular Ruby version managers are RVM and rbenv (though I strongly recommend chruby). They work in totally different ways (RVM overwrites your cd shell builtin function!) but the output of all these tools is the same: They export environment variables so your Ruby code operates on a particular version of Ruby with a particular set of gems.
Here’s a diff<sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> of the environment when we’re using one version of Ruby versus another:
</p>
</div>
<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> rvm</h3>
<div class="outline-text-3" id="text-3-1">
</div><div id="outline-container-sec-3-1-1" class="outline-4">
<h4 id="sec-3-1-1"><span class="section-number-4">3.1.1</span> linux</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
Go to <a href="https://rvm.io/rvm/install">https://rvm.io/rvm/install</a>
</p>

<p>
<code>$ gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB</code>
</p>

<p>
<code>$ \curl -sSL https://get.rvm.io | bash</code>
</p>

<p>
if gnome-terminal
<a href="https://rvm.io/integration/gnome-terminal">https://rvm.io/integration/gnome-terminal</a>
<a href="https://rvm.io/support/faq#shell_login">https://rvm.io/support/faq#shell_login</a>
</p>
</div>
</div>

<div id="outline-container-sec-3-1-2" class="outline-4">
<h4 id="sec-3-1-2"><span class="section-number-4">3.1.2</span> macos</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
Go to <a href="https://rvm.io/rvm/install">https://rvm.io/rvm/install</a>
</p>

<p>
<code>$ gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB</code>
</p>

<p>
<code>$ \curl -sSL https://get.rvm.io | bash</code>
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> rbenv</h3>
<div class="outline-text-3" id="text-3-2">
</div><div id="outline-container-sec-3-2-1" class="outline-4">
<h4 id="sec-3-2-1"><span class="section-number-4">3.2.1</span> linux</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
<code>$ git clone https://github.com/rbenv/rbenv.git ~/.rbenv</code>
<code>$ cd ~/.rbenv &amp;&amp; src/configure &amp;&amp; make -C src</code>
if bash
<code>$ echo 'export PATH="$HOME/.rbenv/bin:$PATH"' &gt;&gt; ~/.bash_profile</code>
if ubuntu with bash
<code>$ echo 'export PATH="$HOME/.rbenv/bin:$PATH"' &gt;&gt; ~/.bashrc</code>
if zsh
<code>$ echo 'export PATH="$HOME/.rbenv/bin:$PATH"' &gt;&gt; ~/.zshrc</code>
then
<code>$~/.rbenv/bin/rbenv init</code>
then
</p>
<p>
<code>$ mkdir -p "$(rbenv root)"/plugins</code>
<code>$ git clone https://github.com/rbenv/ruby-build.git "$(rbenv root)"/plugins/ruby-build</code>
</p>
</div>
</div>
</div>
<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> macos</h3>
<div class="outline-text-3" id="text-3-3">
<p>
<code>$ git clone https://github.com/rbenv/rbenv.git ~/.rbenv</code>
<code>$ cd ~/.rbenv &amp;&amp; src/configure &amp;&amp; make -C src</code>
if bash
<code>$ echo 'export PATH="$HOME/.rbenv/bin:$PATH"' &gt;&gt; ~/.bash_profile</code>
if ubuntu with bash
<code>$ echo 'export PATH="$HOME/.rbenv/bin:$PATH"' &gt;&gt; ~/.bashrc</code>
if zsh
<code>$ echo 'export PATH="$HOME/.rbenv/bin:$PATH"' &gt;&gt; ~/.zshrc</code>
then
<code>$~/.rbenv/bin/rbenv init</code>
then
</p>
<p>
<code>$ mkdir -p "$(rbenv root)"/plugins</code>
<code>$ git clone https://github.com/rbenv/ruby-build.git "$(rbenv root)"/plugins/ruby-build</code>
</p>

<p>
OR just use rvm
</p>

<p>
<code>$ brew install rbenv</code>
<code>$ brew install ruby-build</code>
<code>$ brew upgrade rbenv ruby-build</code>
</p>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> editors</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> vim</h3>
<div class="outline-text-3" id="text-4-1">
<p>
<a href="https://github.com/voloyev/EmacsConfig/blob/master/.vimrc">https://github.com/voloyev/EmacsConfig/blob/master/.vimrc</a>
</p>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> emacs</h3>
<div class="outline-text-3" id="text-4-2">
<p>
<a href="https://github.com/voloyev/EmacsConfig">https://github.com/voloyev/EmacsConfig</a>
</p>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> others</h3>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> git</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> difference from vcs, merccurial</h3>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> pull-request</h3>
</div>
</div>
<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> deploy</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> capistrano</h3>
</div>
<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2"><span class="section-number-3">6.2</span> ansible</h3>
</div>
<div id="outline-container-sec-6-3" class="outline-3">
<h3 id="sec-6-3"><span class="section-number-3">6.3</span> chef</h3>
</div>
<div id="outline-container-sec-6-4" class="outline-3">
<h3 id="sec-6-4"><span class="section-number-3">6.4</span> cd/ci</h3>
<div class="outline-text-3" id="text-6-4">
<p>
<a href="https://semaphoreci.com/blog/2017/07/27/what-is-the-difference-between-continuous-integration-continuous-deployment-and-continuous-delivery.html">https://semaphoreci.com/blog/2017/07/27/what-is-the-difference-between-continuous-integration-continuous-deployment-and-continuous-delivery.html</a>
</p>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p>DEFINITION NOT FOUND.</p></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: voloyev</p>
<p class="date">Created: 2018-05-27 нд 22:54</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.3.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
